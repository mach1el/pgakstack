# PGAKstack

Monitoring your nodes with [Prometheus](prometheus.io) + [Grafana](grafana.org) + [Alertmanager](https://prometheus.io/docs/alerting/latest/alertmanager/) + [Karma](https://karma-dashboard.io/) Stack.<br>
Push alerts to [Slack](https://slack.com/) to keep tracking your system.</br>
Using [traefik.me](traefik.me) DNS for accessing containers resource through traefik 

## Docker compose

```
docker-compose up -d
```

## Docker swarm

```
docker stack deploy -c swarm-traefik.yml reverse_proxy
docker stack deploy -c swarm-monitor.yml pgak
```

## Variables

| Name | Description | Default |
|------|-------------|---------|
|<a name="DOMAIN"></a> [DOMAIN](#) | Set DNS for cotainers resource | `traefik.me` |
|<a name="GF_USER"></a> [GF_SECURITY_ADMIN_USER](#) | User for Grafana dashboard  | `admin` |
|<a name="GF_PASSWD"></a> [GF_SECURITY_ADMIN_PASSWORD](#) | Password for Grafana dashboard  | `grafana` |
|<a name="TRAEFIK_USER"></a> [TRAEFIK_USER](#) | User for traefik middlewares authentication  | `Not set` |
|<a name="TRAEFIK_PASSWD"></a> [TRAEFIK_PASSWORD](#) | Password for traefik middlewares authentication  | `Not set` |

* **Note**: for `TRAEFIK_PASSWORD` it must be generated by htpasswd

```
htpasswd -nBC 10 $TRAEFIK_USER
```

## Define slack variable
In alertmanager [config](/alertmanager/config.yml) you must define your `(( API ))` and `(( channel ))` for your Slack workspace

## Define alert rules
Refer at [Awesome prometheus alerts](https://awesome-prometheus-alerts.grep.to/) you can customize your rules to [rules](/prometheus/rules.yml)


## SSL 

Can use free SSL on `traefik.me` domain with [cert.pem](http://traefik.me/cert.pem) and [privkey](http://traefik.me/privkey.pem) 